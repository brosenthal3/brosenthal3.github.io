<!DOCTYPE html>
<html>
<head>
	<title>Text encrypter</title>
	<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
	<link rel="stylesheet" type="text/css" href="style.css">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>
	<div class="main" role="main">
	<div class="container">
		<div class="mb-3 text-muted"><small>Made by Ben Rosenthal. Visit <a href="https://www.ikbenben.com" target="_blank">ikbenben.com</a> for more.</small></div>
		<h1 id="normalHeader">Text encryption and decryption</h1>
		<h1 id="encryptHeader">Text encryption</h1>
		<h1 id="decryptHeader">Text decryption</h1>
		<div id="choose">
			<button id="chooseEn" class="btn btn-success">Encryption</button>
			<button id="chooseDe" class="btn btn-success">Decryption</button>
		</div>

		<div id="content">
			<button id="back" class="btn btn-secondary mb-2">Back</button>
			<input type="number" name="key1" id="key1" placeholder="Key" min="1" max="40" class="form-control mb-2">
			<textarea id="input" placeholder="Write down your text in here" class="form-control mb-2"></textarea>
			<button id="encrypt" class="btn btn-success">Encrypt text</button>
			<button id="decrypt" class="btn btn-success">Decrypt text</button>

			<div id="encryptedText">
				<br>
				The encrypted text is:
				<div id="encryptedText2"></div> <button class="btn btn-dark btn-sm mt-3 copy">Copy Text</button>
				<br>
			</div>
			<br>
			<div id="decryptedText">
				<br>
				The decrypted text is:
				<div id="decryptedText2"></div> <button class="btn btn-dark btn-sm mt-3 copy">Copy Text</button>
				<br>
			</div>
			<textarea id="textToCopy"></textarea>
		</div>
	</div>
</div>

	


	<script type="text/javascript">
		//UI code show the correct part of the website according to what you chose
		document.getElementById('chooseEn').onclick = () => {
			document.getElementById('choose').style.display="none";
			document.getElementById('normalHeader').style.display="none";
			document.getElementById('content').style.display="block";
			document.getElementById('encrypt').style.display="block";
			document.getElementById('encryptHeader').style.display="block";
		}
		document.getElementById('chooseDe').onclick = () => {
			document.getElementById('choose').style.display="none";
			document.getElementById('normalHeader').style.display="none";
			document.getElementById('encrypt').style.display="none";
			document.getElementById('content').style.display="block";
			document.getElementById('decrypt').style.display="block";
			document.getElementById('decryptHeader').style.display="block";
		}

		document.getElementById('back').onclick = () => {
			document.getElementById('choose').style.display="block";
			document.getElementById('normalHeader').style.display="block";
			document.getElementById('content').style.display="none";
			document.getElementById('decrypt').style.display="none";
			document.getElementById('decryptHeader').style.display="none";
			document.getElementById('encryptHeader').style.display="none";
			document.getElementById('decryptedText').style.display="none";
			document.getElementById('encryptedText').style.display="none";
			document.getElementById('key1').value=null;
			document.getElementById('input').value=null;
		}
		document.querySelectorAll('.copy').forEach((item) => {
			item.addEventListener('click', () => {
				var toCopy = document.getElementById('textToCopy').value;
				let newTextarea = document.createElement('textArea');
				newTextarea.value = toCopy;
				document.body.appendChild(newTextarea);
				newTextarea.focus();
				newTextarea.select();
				document.execCommand("copy");
				console.log(toCopy);
				document.body.removeChild(newTextarea);
			});
		})


		//Run the encryption function when you press on that button
		var button = document.getElementById('encrypt');
		button.addEventListener('click', encrypt);
		//Run the decryption function when you press on that button
		var button2 = document.getElementById('decrypt');
		button2.addEventListener('click', decrypt)

		//Encryption function
		function encrypt() {
			//declare all needed variables
			var text = document.getElementById('input').value;
			var key1 = document.getElementById('key1').value;
			//check if the key is below 40. Run encryption if it is
			if (key1>40) {
				alert('Enter a key below 49 please');
			}else{
				var encryptedCode=[];
				var encryptedText=[];
				var asciiCode;
				var asciiEncrypted;

				//split the text into an array
				var textArray=text.split('');

				//loop through all characters of the array
				for (let i = 0; i < textArray.length; i++){
					
					//Transform each character to it's ascii code
					asciiCode = textArray[i].charCodeAt(0);

					if (asciiCode%2 > 0) {
						//if the ascii code isn't even - remove n (value of key) from it
						asciiEncrypted = asciiCode- +key1;
					} else{
						//if it is even - add n (value of key) to it
						asciiEncrypted = asciiCode+ +key1;
					}
					console.log(asciiCode+" Ecnrypted="+asciiEncrypted);
					//add each (encrypted) ascii code to an array
					encryptedCode.push(asciiEncrypted);
				}

				//transform each ascii code to it's character
				for (let i = 0; i < encryptedCode.length; i++){
					 
					var asciiToText = String.fromCharCode(encryptedCode[i]);
					
					//add each new character to another array that contains the encrypted characters
					encryptedText.push(asciiToText);
				}
				//make a string out of the array of the encrypted characters
				var finished=document.createTextNode(encryptedText.join(''));
				//View the encrypted string on the page
				document.getElementById('encryptedText').style.display="block";
				if (document.getElementById('encryptedText2').hasChildNodes()) {
				document.getElementById('encryptedText2').removeChild(document.getElementById('encryptedText2').firstChild);	
				}
				document.getElementById('encryptedText2').appendChild(finished);
				document.getElementById('textToCopy').value = encryptedText.join('');
			}
				
			
		}

		//decryption function
		function decrypt() {
			//declare all needed variables
			var textD = document.getElementById('input').value;
			var key1 = document.getElementById('key1').value;

			var decryptedCode=[];
			var decryptedText=[];
			var asciiCodeD;
			var asciiDecrypted;

			//split the text intro an array
			var textArrayD=textD.split('');

			for (let i = 0; i < textArrayD.length; i++){
				
				//Transform each character into it's ascii code
				asciiCodeD = textArrayD[i].charCodeAt(0);

				//check if the key is even or odd
				if (key1%2 == 0) {
					console.log(key1);
					if ((asciiCodeD-key1)%2 > 0) {
						//if it it's odd - add n (value of key) to the code
						asciiDecrypted = asciiCodeD+ +key1;
					} else{
						//if it is even - remove n (value of key) from the code
						asciiDecrypted = asciiCodeD- +key1;
					}
				}else{
					console.log(key1);
					if ((asciiCodeD-key1)%2 > 0) {
						//if it it's odd - remove n (value of key) to the code
						asciiDecrypted = asciiCodeD+ +key1;
					} else{
						//if it is even - add n (value of key) from the code
						asciiDecrypted = asciiCodeD- +key1;
					}
				}

				
				console.log(asciiCodeD+" Decrypted="+asciiDecrypted);

				//add each (decrypted) ascii to an array
				decryptedCode.push(asciiDecrypted);
			}

			//transform each ascii code to it's character
			for (let i = 0; i < decryptedCode.length; i++){
				 
				var asciiToTextD = String.fromCharCode(decryptedCode[i]);
				
				//add the decrypted character to an array
				decryptedText.push(asciiToTextD);
			}

			//make a string out of the array of the decrypted characters
			var finishedD = document.createTextNode(decryptedText.join(''));

			//view the decrypted string on the page
			document.getElementById('decryptedText').style.display="block";
			if (document.getElementById('decryptedText2').hasChildNodes()) {
				document.getElementById('decryptedText2').removeChild(document.getElementById('decryptedText2').firstChild);	
			}
			document.getElementById('decryptedText2').appendChild(finishedD);
			document.getElementById('textToCopy').value = decryptedText.join('');
		}


	</script>

</body>
</html>